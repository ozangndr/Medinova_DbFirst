@model List<Medinova.Models.AboutItem>
@{
    ViewBag.Title = "Hakkımızda Maddeleri";
    Layout = "~/Views/Shared/_Layout.cshtml";
    int count = 0;
}

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="mb-0 text-dark"><i class="fas fa-list-ul text-primary"></i> Hakkımızda Maddeleri</h2>
            <small class="text-muted">Ana sayfadaki hakkımızda bölümü ikonlu maddeleri</small>
        </div>
        <a href="@Url.Action("Create")" class="btn btn-primary px-4 shadow-sm">
            <i class="fas fa-plus"></i> Yeni Madde Ekle
        </a>
    </div>

    <div class="card shadow border-0">
        <div class="card-body p-0">
            <table class="table table-hover align-middle mb-0">
                <thead class="bg-light">
                    <tr>
                        <th class="ps-4" style="width: 60px;">#</th>
                        <th style="width: 100px;">İkon</th>
                        <th>Madde Başlığı</th>
                        <th class="text-end pe-4" style="width: 250px;">İşlemler</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model)
                    {
                        count++;
                        <tr>
                            <td class="ps-4 text-muted">@count</td>
                            <td>
                                <div class="bg-light rounded-circle d-flex align-items-center justify-content-center shadow-sm"
                                     style="width: 45px; height: 45px; overflow: hidden;">

                                    @if (!string.IsNullOrEmpty(item.Icon))
                                    {
                                        <img src="@item.Icon" alt="icon"
                                             style="width: 100%; height: 100%; object-fit: cover;"
                                             onerror="this.src='https://via.placeholder.com/45?text=?'">
                                    }
                                    else
                                    {
                                        <i class="fas fa-image text-muted"></i>
                                    }
                                </div>
                            </td>
                            <td class="fw-bold text-dark">
                                @item.Name
                            </td>
                            <td class="text-end pe-4">
                                <div class="btn-group shadow-sm">
                                    <a href="@Url.Action("Update", new { id = item.AboutItemId })"
                                       class="btn btn-sm btn-outline-warning px-3" title="Düzenle">
                                        <i class="fas fa-edit"></i> Düzenle
                                    </a>

                                    <button type="button"
                                            class="btn btn-sm btn-outline-danger px-3 btn-delete"
                                            data-id="@item.AboutItemId"
                                            data-name="@item.Name">
                                        <i class="fas fa-trash-alt"></i> Sil
                                    </button>
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        document.querySelectorAll('.btn-delete').forEach(button => {
            button.addEventListener('click', function () {
                const id = this.getAttribute('data-id');
                const name = this.getAttribute('data-name');

                Swal.fire({
                    title: 'Emin misiniz?',
                    text: `"${name}" maddesi kalıcı olarak silinecektir!`,
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#d33',
                    cancelButtonColor: '#6c757d',
                    confirmButtonText: 'Evet, Sil!',
                    cancelButtonText: 'İptal',
                    reverseButtons: true
                }).then((result) => {
                    if (result.isConfirmed) {
                        // Action ismine dikkat: AboutItemController içindeki Delete'e gitmeli
                        window.location.href = "/Admin/AboutItem/Delete/" + id;
                    }
                });
            });
        });
    </script>
}